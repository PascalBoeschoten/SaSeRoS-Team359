#define SENSOR_TOUCH_FRONT IN_1
#define LIGHT_SENSOR IN_2
#define SENSOR_TOUCH_BACK IN_3

#define MOTOR_RIGHT_OUT OUT_A
#define MOTOR_LEFT_OUT OUT_B
#define ULTRASONIC_THRESHOLD 30

#include "../basic_functions/functions.h"
#include "../scanner.h"

// Task for testing the touch sensor readout
task read_touch_sensor() {
    SetSensorTouch(SENSOR_TOUCH_FRONT);

    while(true){
        if(Sensor(SENSOR_TOUCH_FRONT) == 1) {
            OnFwd(OUT_AC, 100);
        }
        else {
            Off(OUT_AC);
        }
    }
}

// Just empty for now. Should turn a certain amount of degrees.
void turnDegrees(int degrees) {
    ;
}

// Task for testing ultrasonic sensor readout
task read_ultrasonic_sensor() {
    SetSensorUltrasonic(ULTRASONIC_IN);
    
    while(true){
        //the ultrasonic sensor needs time to read the values
        //that is why we have the wait
        Wait(500);
        ClearScreen();
        NumOut(0, 0, SensorUS(ULTRASONIC_IN));
    }
}

// Task that beeps every second so you know the system
// is running
task heartbeat() {
    while(true) {
        PlayTone(500, 100);
        Wait(5000);
    }
}

task main() {
     start heartbeat;

     while(true) {
        ClearScreen();
        TextOut(0,0,"Starting scan...");
        Wait(300);
        ultrasonic_scan();
     }
}
